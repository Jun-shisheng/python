# Python数据分析与应用 第二版（微课版）
---
## 课后的实训题：
---
## 房屋销售数据统计分析 `3chapter.py`

### 1. 数据读取与基础操作
- 读取 CSV 文件，预览数据
- 查看数据的维度（`ndim`）、形状（`shape`）与列名
- 使用 `.iloc` 和 `.loc` 进行数据索引操作

### 2. 统计分析
- 对“房屋价格/元”字段计算：
  - 平均值（mean）、最大值（max）、最小值（min）
  - 众数（mode）、分位数（quantile）
  - 综合描述统计（`describe()`）

### 3. 特征工程
- 新增特征：`new_postcode`，提取“地区邮编”前四位作为地区标识
- 将“房屋出售时间”字段转换为时间格式（`to_datetime`）

### 4. 分组与聚合分析
- 使用 `groupby` 对“房屋类型”与 `new_postcode` 进行分组
- 计算分组后的房价均值（`transform('mean')`）

### 5. 数据透视与交叉表分析
- 使用 `pivot_table` 构建透视表，查看不同房屋类型在不同地区的平均房价
- 使用 `crosstab` 构建交叉表，统计各房屋类型与地区组合的频数分布（包含总计行/列）

---

## 病患数据分析 `4chapter.py`

### 1. 数据读取与合并
- 从 Excel 文件中读取两个数据集：
  - `healthcare-dataset-stroke.xlsx`（中风相关数据）
  - `healthcare-dataset-age_abs.xlsx`（补充年龄信息）
- 使用 `merge` 函数以“编号”为主键外连接合并两个数据集
- 重置索引保持数据连续性

### 2. 异常值处理
- 检查“年龄/岁”字段的值是否在合理范围（0 < 年龄 ≤ 120）
- 删除年龄为空或超出合理范围的记录
- 重置索引

### 3. 年龄离散化处理
- 自定义分箱区间：`[0, 20, 40, 60, 80, 120]`
- 对“年龄/岁”进行等宽离散化，使用 `pd.cut()` 方法
- 为每个年龄段添加标签（如："0-19岁", "20-39岁" 等）

### 4. 分段统计与输出
- 输出每个年龄区间的范围
- 显示处理后的数据集中的编号、年龄和年龄分段
- 统计每个年龄区间的人数，并以格式化方式打印

### 5. 数据导出
- 将处理后的完整数据保存为 Excel 文件：`data/merged_result.xlsx`
  
---

## 学生成绩分析与特征关系可视化 `5chapter1.py`

### 1. 数据读取与准备
- 从 `student_grade.xlsx` 读取学生成绩数据集
- 设置 matplotlib 中文显示（黑体）、避免负号乱码

### 2. 成绩分段与分布统计
- 使用 `pd.cut` 对“总成绩”进行分箱：
  - 区间设置为 `[0, 150, 200, 250, 300]`
  - 标签设为：`['不及格', '及格', '良好', '优秀']`
- 添加新列“总成绩区间”
- 使用 `value_counts()` 统计各成绩段人数

### 3. 成绩分布可视化
#### 饼图展示成绩分布
- 使用 `pandas.Series.plot.pie()` 绘制饼图
- 配色包括淡红、淡蓝、浅绿色
- 设置 `explode` 增强视觉突出度
- 保持比例 (`axis('equal')`)

#### 箱线图展示单科成绩分布
- 对“数学成绩”、“阅读成绩”、“写作成绩”绘制箱线图
- 使用 seaborn `boxplot()` 进行可视化
- 显示均值点（红边白心圆），观察中位数、异常值等统计特征

### 4. 特征与总成绩关系分析
#### 自我效能感影响
- 使用 `groupby` 和 `mean()` 计算不同“自我效能感”水平下的总成绩均值
- 绘制柱状图展示三类效能感（低、中、高）对应平均总成绩差异

#### 课程准备情况影响
- 计算完成/未完成准备下的平均总成绩差异
- 使用柱状图可视化准备与否对成绩的影响
- 柱顶标注均值（保留一位小数）

### 5. 分析结果输出
- 打印不同自我效能感的平均总成绩
- 计算并输出准备情况对平均成绩的提升幅度（例如：“完成准备的学生比未完成的平均高 X 分”）

---
